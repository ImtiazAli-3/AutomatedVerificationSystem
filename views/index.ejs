<%- include('header') %>

<div id="page-container">
  <main id="content-wrap">
    <h2></h2>
    <p></p>

    <div id="carousel" class="carousel">
        <!-- Slideshow for the front page, images generated by AI, prompt 'generate 
          3 images that i can use for my front page e commerce website for merch' -->
        <div class="slide active"><img src="./uploads/slide1.jpg" alt="Slide 1"></div>
        <div class="slide"><img src="./uploads/slide2.jpg" alt="Slide 2"></div>
        <div class="slide"><img src="./uploads/slide3.jpg" alt="Slide 3"></div>
        <a class="prev" onclick="changeSlide(-1)">&#10094;</a>
        <a class="next" onclick="changeSlide(1)">&#10095;</a>
      </div>
      <h2 class="featured-heading">Featured Items</h2>
      <div id="indexitems" class="indexitems-container"></div>
</main>

<script>
fetch('/indexitems')
  .then(response => response.json())
  .then(indexitems => {
    const itemsContainer = document.getElementById('indexitems');
    itemsContainer.innerHTML = ''; 
    indexitems.forEach(item => {
      itemsContainer.innerHTML += `
        <div class="item">
          <a href="/item/${item.id}">
          <img src="/uploads/${item.image}">
          <h3>${item.name}</h3>
          </a>
          <p>Â£${item.price}</p>
        </div>
      `;
    });
  });


let slideIndex = 0;
showSlides(slideIndex);

function changeSlide(n) {
  showSlides(slideIndex += n);
}

function currentSlide(n) {
  showSlides(slideIndex = n);
}

function showSlides(n) {
  let i;
  let slides = document.getElementsByClassName("slide");
  if (n >= slides.length) {slideIndex = 0}    
  if (n < 0) {slideIndex = slides.length - 1}
  for (i = 0; i < slides.length; i++) {
      slides[i].style.display = "none";  
  }
  slides[slideIndex].style.display = "block";  
}

function autoChangeSlides() {
  slideIndex++;
  showSlides(slideIndex);
  setTimeout(autoChangeSlides, 4000);
}

autoChangeSlides(); //auto slideshow


var userData = {
    userId: <%- JSON.stringify(user ? user.id : null) %>
  };
</script> 

<%- include('footer') %>
</div>